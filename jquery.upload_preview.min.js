;(function($,window,document,undefined){var Previewer=function(ele,opt){this.$element=ele;this.defaults={width:'200px',height:'200px',backgroundSize:'cover',fontSize:'16px',borderRadius:'5px',border:'0',lang:'zh-cn',afterPreview:function(){},};this.options=$.extend({},this.defaults,opt);};Previewer.prototype={preview:function(){_setHTMLnCSS({$element:this.$element,width:this.options.width,height:this.options.height,backgroundSize:this.options.backgroundSize,fontSize:this.options.fontSize,borderRadius:this.options.borderRadius,border:this.options.border,lang:this.options.lang,});_imgPreview(this.$element,this.$element.children('input'),this.options.afterPreview);return this.$element;},};var _setHTMLnCSS=function(param){switch(param.lang){case'zh-cn':param.$element.append('<span>点击选择图片</span><div class="up_again">点击重新<br>选择图片</div>');break;case'en':param.$element.append('<span>click to choose a pic</span><div class="up_again">click again<br>to choose another</div>');break;default:param.$element.append('<span>click here to choose pic</span><div class="up_again">click again<br>choose pic</div>');}
var className=param.$element.attr('class').trim();var end=className.indexOf(' ');if(end!==-1){className=className.substr(0,end);}
$('head').append('<style>'+'.'+className+' { font-size: '+param.fontSize+'; width: '+param.width+'; height: '+param.height+'; border-radius: '+param.borderRadius+';border: '+param.border+'; position: relative; overflow: hidden; background-color: #eee; background-size: '+param.backgroundSize+'; background-repeat: no-repeat; background-position: center; -webkit-mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);}'+'.'+className+' span { display: block; padding: 0; line-height: '+param.height+'; text-align: center; }'+'.'+className+' input { position: absolute; font-size: 2000px; z-index: 200; top: 0; right: 0; opacity: 0; -ms-filter: "alpha(opacity=0)"; cursor: pointer; }'+'.'+className+' .up_again { display: table-cell; vertical-align: middle; text-align: center; width: '+param.width+'; height: '+param.height+'; opacity: 0; color: #fff; transition: 0.3s ease-in-out; -moz-transition: 0.3s ease-in-out; -webkit-transition: 0.3s ease-in-out; -o-transition: 0.3s ease-in-out; line-height: 1.6; }'+'.'+className+':hover .up_again { opacity: 1; background: rgba(0, 0, 0, 0.5); }</style>');};var _readURL=function(previewArea,input,afterPreview){if(input.files&&input.files[0]){var reader=new FileReader();reader.onload=function(e){previewArea.css('background-image','url('+e.target.result+')');afterPreview(e.target.result);};reader.readAsDataURL(input.files[0]);$(input).next('span').hide();}};var _imgPreview=function(previewArea,input,afterPreview){input.change(function(){_readURL(previewArea,this,afterPreview);});};$.fn.uploadPreview=function(options){var previewer=new Previewer(this,options);return previewer.preview();};})(jQuery,window,document);
